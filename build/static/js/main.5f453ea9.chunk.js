(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,a){},119:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),s=a.n(c),o=a(123),l=(a(63),a(9)),u=a(3),i=a(2),m=a.n(i),d=a(56),p=a(8),f=a(11),E=a(5),b=a(18),h=function(e,t){var a=t.payload;switch(t.type){case"SET_PAGENUM":return Object(u.a)({},e,{pageNum:a});case"SET_ITEMS":return Object(u.a)({},e,{items:a});case"SET_PAGES":return Object(u.a)({},e,{pages:a});case"SET_TOTAL":return Object(u.a)({},e,{total:a});case"SET_START":return Object(u.a)({},e,{start:a});case"SET_END":return Object(u.a)({},e,{end:a});case"SET_REFRESH":return Object(u.a)({},e,{toggle:a});case"SEARCH_ITEMS":return Object(u.a)({},e,{title:a});default:return e}},g=function(e){var t=e.request,a=e.data,r=void 0===a?"data":a,c=e.pages,s=void 0===c?"lastPage":c,o=e.total,i=void 0===o?"total":o,m=e.take,d=void 0===m?15:m,p={items:[],pageNum:1,pages:0,total:0,take:d,toggle:!1,start:1,end:b.b.pageNumbers},g=Object(n.useReducer)(h,p),v=Object(E.a)(g,2),j=v[0],S=j.toggle,y=j.title,N=j.pageNum,O=Object(f.a)(j,["toggle","title","pageNum"]),w=v[1];return Object(n.useEffect)(function(){t(N,d,y).then(function(e){w({type:"SET_ITEMS",payload:e[r]}),w({type:"SET_PAGES",payload:e[s]}),w({type:"SET_TOTAL",payload:e[i]})}).catch(function(e){var t=e.response;t&&404===t.status&&(w({type:"SET_ITEMS",payload:[]}),w({type:"SET_PAGES",payload:0}),w({type:"SET_TOTAL",payload:0}),w({type:"SET_PAGENUM",payload:1}),l.toast.error("No result/s found"))})},[S,y,N]),Object(n.useEffect)(function(){w({type:"SET_ITEMS",payload:[]})},[y,N]),{state:Object(u.a)({toggle:S,pageNum:N,take:d},O),dispatch:w}},v=r.a.createContext({}),j=a(27),S=a.n(j);function y(e,t){return S.a.orderBy(e,[t.path],[t.order])}var N=function(e){return e?new Date(e).toLocaleDateString():null},O=function(e){var t=e.id,a=e.name;return{id:t,label:w(a),value:a}},w=function(e){return S.a.startCase(e)},x=a(20),k=a.n(x);k.a.interceptors.response.use(function(e){return e},function(e){return function(e){if(e.response&&e.response.data.status&&"ExpiredJwtToken"===e.response.data.status.name)return l.toast.error("jwt is expired"),Promise.reject(e);e.response&&e.response.status>=400&&e.response.status<500||l.toast.error("An unexpected error occurrred.");return Promise.reject(e)}(e)}),k.a.interceptors.request.use(function(e){return e.baseURL=Object({NODE_ENV:"production",PUBLIC_URL:""}).API_URL||b.a,e});var T={get:k.a.get,post:k.a.post,put:k.a.put,delete:k.a.delete,axios:k.a,setJwt:function(e){var t=e.token;k.a.interceptors.request.use(function(e){return e.headers.Authorization="Bearer ".concat(t),e})}};var A=a(48),C=a.n(A);function I(e){var t=e.token,a=e.refreshToken;localStorage.setItem("access-token",t),localStorage.setItem("refresh-token",a)}function D(){return(D=Object(p.a)(m.a.mark(function e(t){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/auth/login",t).then(function(e){I(e.data.jwt)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function _(){return(_=Object(p.a)(m.a.mark(function e(t){var a,n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/auth/register",t).then(function(e){return e.data});case 2:if(a=e.sent,n=a.jwt){e.next=6;break}return e.abrupt("return",!1);case 6:return I(n),e.abrupt("return",!0);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function P(){return(P=Object(p.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.setJwt(R()),F(),e.next=4,T.post("/token/revoke",{refreshToken:R().refreshToken});case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function F(){localStorage.removeItem("refresh-token"),localStorage.removeItem("access-token")}function U(){try{var e=localStorage.getItem("access-token");return Object(u.a)({},C()(e))}catch(t){return null}}var R=function(){return{token:localStorage.getItem("access-token"),refreshToken:localStorage.getItem("refresh-token")}},M={login:function(e){return D.apply(this,arguments)},register:function(e){return _.apply(this,arguments)},logout:function(){return P.apply(this,arguments)},getCurrentUser:function(){return U()?Object(u.a)({},U().data):null},isUsernameTaken:function(e){return T.get("/auth/is-taken?username="+e).then(function(e){return e.data})},isEmailTaken:function(e){return T.get("/auth/is-taken?email="+e).then(function(e){return e.data})},jwt:R,isValidUser:function(){return!!U()},isAdmin:function(){return U()?U().data.isAdmin:null}};function L(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return T.get("/api/animes/page/".concat(e,"?limit=").concat(t,"&title=").concat(a)).then(function(e){return e.data.data})}function B(){return T.get("/api/genres").then(function(e){return e.data})}function G(e){return T.get("/api/animes/".concat(e)).then(function(e){return e.data})}var q=[{label:"Winter",value:"winter"},{label:"Spring",value:"spring"},{label:"Summer",value:"summer"},{label:"Fall",value:"fall"}],J=[{label:"TV",value:"tv"},{label:"Movie",value:"movie"},{label:"OVA",value:"ova"},{label:"ONA",value:"ona"},{label:"Other",value:"other"}];function V(e){return T.setJwt(M.jwt()),T.post("/api/animes",e).then(function(e){return e.data})}function H(e,t){return T.setJwt(M.jwt()),T.put("/api/animes/"+e,t).then(function(e){return e.data})}var z=Object(n.memo)(function(e){var t=g({request:L,take:b.b.perPage}),a=t.state,n=a.pageNum,c=a.items,s=a.pages,o=a.total,l=Object(f.a)(a,["pageNum","items","pages","total"]),i=t.dispatch,E=function(){var e=Object(p.a)(m.a.mark(function e(t){var a,n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(d.a)(c),e.prev=1,n=a.filter(function(e){return e.id!==t.id}),i({type:"SET_ITEMS",payload:n}),e.next=6,r=t.id,T.setJwt(M.jwt()),T.delete("/api/animes/"+r).then(function(e){return e.data});case 6:return e.abrupt("return",n.length>0);case 9:return e.prev=9,e.t0=e.catch(1),i({type:"SET_ITEMS",payload:a}),e.abrupt("return",a.length>0);case 13:case"end":return e.stop()}var r},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(v.Provider,{value:{state:Object(u.a)({animes:c,pages:s,pageNum:n,total:o},l),onDelete:E,onRefresh:function(){i({type:"SET_REFRESH",payload:function(e){return!e}})},onPageChange:function(e){i({type:"SET_PAGENUM",payload:e})},onSort:function(e){i({type:"SET_ITEMS",payload:y(c,e)})},onSearch:function(e){i({type:"SEARCH_ITEMS",payload:e})},onSetStart:function(e){i({type:"SET_START",payload:e})},onSetEnd:function(e){i({type:"SET_END",payload:e})}}},e.children)}),W=a(96),Y=a(121),K=function(e){return function(t){return r.a.createElement(e,Object.assign({auth:M},t))}},Q=K(function(e){var t=e.auth,a=(Object(f.a)(e,["auth"]),function(){var e=Object(p.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.logout();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}());return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement("div",{className:"container"},r.a.createElement(W.a,{className:"navbar-brand",to:"/"},"KITCHANIME"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse d-flex justify-content-end",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav"},t.isValidUser()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-user  text-warning"}),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link active",to:"/home"},w(t.getCurrentUser().username))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"/login",onClick:a},"Logout"))),!t.isValidUser()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link",to:"/login"},"Login")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link",to:"/register"},"Register")))))),r.a.createElement("style",{jsx:""},"\n          .navbar {\n            margin-bottom: 20px;\n          }\n          .fa-user {\n            margin-top: 12px !important;\n          }import withAuth from './../auth/registerForm';\n\n        ")))}),X=a(124),Z=a(120),$=a(122),ee=function(e){return r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,e.columns.map(function(t,a){return r.a.createElement("th",{className:"clickable",key:a,onClick:function(){return function(t){var a=Object(u.a)({},e.sortColumn);a.path===t?a.order="asc"===a.order?"desc":"asc":(a.path=t,a.order="asc"),e.onSort(a)}(t.path)}},t.label," ",function(t){var a=e.sortColumn;return t.path?t.path!==a.path?null:"asc"===a.order?r.a.createElement("i",{className:"fa fa-sort-asc"}):r.a.createElement("i",{className:"fa fa-sort-desc"}):null}(t))})))},te=function(e){var t=e.data,a=e.columns;return r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement("tr",{key:e.id},a.map(function(t,a){return r.a.createElement("td",{key:a},function(e,t){return t.content?t.content(e):S.a.get(e,t.path)}(e,t))}))}))},ae=function(e){var t=e.columns,a=e.sortColumn,n=e.onSort,c=e.data;return r.a.createElement("table",{className:"table table-bordered table-hover "},r.a.createElement(ee,{columns:t,sortColumn:a,onSort:n}),r.a.createElement(te,{columns:t,data:c}))},ne=function(e){var t=b.b.pageNumbers,a=Object(n.useContext)(v),c=a.state,s=c.pageNum,o=c.pages,l=c.start,u=c.end,i=a.onPageChange,m=a.onSetStart,d=a.onSetEnd;Object(n.useEffect)(function(){u>o&&1!==l&&(p(),f())},[s]);var p=function(){return m(l-1)},f=function(){return d(u-1)},E=function(e){s!==e&&i(e)},h=function(e){E(e+1),u!==o&&(m(l+1),d(u+1))},g=function(){return o>t},j=function(){return 1===s?"disabled":""},S=function(){return o===s?"disabled":""};return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col d-flex justify-content-start px-0"},r.a.createElement("nav",null,r.a.createElement("ul",{className:"pagination"},g()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"page-item ".concat(j())},r.a.createElement("button",{className:"page-link",onClick:function(){1!==s&&(E(1),m(1),d(t))}},"first")),r.a.createElement("li",{className:"page-item ".concat(j())},r.a.createElement("button",{className:"page-link","aria-label":"Previous",onClick:function(){return E(s-1),void(1!==l&&(p(),f()))}},"\xab"))),o>1&&function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a}(l,o<t?o:u).map(function(e){return r.a.createElement("li",{key:e,className:s===e?"page-item active":"page-item"},r.a.createElement("button",{className:"page-link",onClick:function(){return E(e)}},e))}),g()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"page-item ".concat(S())},r.a.createElement("button",{className:"page-link","aria-label":"Next",onClick:function(){return h(s)}},"\xbb")),r.a.createElement("li",{className:"page-item ".concat(S())},r.a.createElement("button",{className:"page-link",onClick:function(){E(o),m(o-(t-1)),d(o)}},"last")))))),r.a.createElement("div",{className:"pages px-0 col d-flex justify-content-end"},r.a.createElement("p",{className:"page-of"},"".concat(s," of ").concat(o))),r.a.createElement("style",{jsx:""},"\n            .pages {\n              text-align: right;\n            }\n            .page-of {\n              margin-top: 10px;\n            }\n          ")))},re=function(e){var t=Object(n.useContext)(v),a=t.onPageChange,c=t.onSearch,s=t.onSetEnd,o=t.onSetStart,l=Object(n.useState)(""),u=Object(E.a)(l,2),i=u[0],d=u[1],f=function(){var e=Object(p.a)(m.a.mark(function e(t){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i){e.next=3;break}return e.abrupt("return");case 3:o(1),s(b.b.pageNumbers),a(1),c(i);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:f},r.a.createElement("input",{type:"text",name:i,value:i,onChange:function(e){return d(e.target.value)},className:"form-control",placeholder:"Search title"}),r.a.createElement("button",{className:"btn-search btn btn-primary ml-2"},r.a.createElement("span",{className:"fa fa-search mr-1"}),"SEARCH")),r.a.createElement("style",{jsx:""},"\n        form {\n          display: flex;\n        }\n        .btn-search {\n          width: 13%;\n        }\n      "))},ce=function(e){var t=e.isLoaded,a=e.children;return r.a.createElement(r.a.Fragment,null,!t&&r.a.createElement("div",{className:"spin d-flex justify-content-center justify-items-center"},r.a.createElement("div",{className:"spinner spinner-grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),t&&a,r.a.createElement("style",{jsx:""},"\n        .spin {\n          position: fixed;\n          z-index: 1031;\n          top: 40%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n      "))},se=K(function(e){var t=e.auth,a=Object(n.useContext)(v),c=a.state,s=c.animes,o=c.pageNum,u=c.start,i=c.end,d=a.onDelete,f=a.onRefresh,b=a.onPageChange,h=a.onSort,g=a.onSearch,j=a.onSetStart,S=a.onSetEnd,y=Object(n.useState)({path:"name",order:"asc"}),O=Object(E.a)(y,2),w=O[0],x=O[1],k=[{path:"title",label:"Title",content:function(e){return r.a.createElement(W.a,{to:"/animes/".concat(e.id)},e.title)}},{path:"season",label:"Season"},{path:"releaseDate",label:"Release"},{path:"type",label:"Type"},{label:"Genres",content:function(e){return A(e.genres)}},{label:"Studios",content:function(e){return A(e.studios)}},{key:"actions",label:"Actions",content:function(e){return r.a.createElement("div",{className:""},r.a.createElement(W.a,{to:"/animes/".concat(e.id)},r.a.createElement("button",{className:"btn btn-warning btn-sm mr-1 text-white"},r.a.createElement("span",{className:"fa fa-pencil mr-1"}),"EDIT")),r.a.createElement("button",{onClick:Object(p.a)(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)})),className:"btn btn-danger btn-sm text-white"},r.a.createElement("span",{className:"fa fa-trash mr-1"}),"DELETE"))}}],T=function(){var e=Object(p.a)(m.a.mark(function e(a){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isAdmin()){e.next=3;break}return l.toast.error("Unauthorized user"),e.abrupt("return");case 3:return e.next=5,d(a);case 5:if(e.sent){e.next=10;break}return b(o-1),u>1&&j(u-1),S(i-1),e.abrupt("return");case 10:f();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),A=function(e){return e.map(function(e,t){return r.a.createElement("span",{key:t,className:"badge ml-1  badge-secondary"},e.name)})};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row no-gutters "},r.a.createElement("div",{className:"col-6 d-flex justify-content-start "},t.isAdmin()&&r.a.createElement(W.a,{to:"/animes/new"},r.a.createElement("button",{className:"btn btn-success mr-2 mt-1"},r.a.createElement("span",{className:"fa fa-plus mr-1"}),"NEW ANIME")),r.a.createElement("div",null,r.a.createElement(W.a,{to:"/"},r.a.createElement("button",{onClick:function(){return g("")},className:"btn btn-secondary mt-1"},r.a.createElement("span",{className:"fa fa-refresh mr-1"}),"REFRESH"))))),r.a.createElement("div",{className:"col-12 mb-2 mt-3",style:{padding:0}},r.a.createElement(re,null)),r.a.createElement(ce,{isLoaded:s.length>0},r.a.createElement(ae,{columns:t.isAdmin()?k:[].concat(k).filter(function(e){return"actions"!==e.key}),data:s.map(function(e){return e.releaseDate=N(e.releaseDate),e}),sortColumn:w,onSort:function(e){h(e),x(e)}}),r.a.createElement(ne,null)))}),oe=function(e){var t=e.total,a=e.title;return r.a.createElement("div",{className:"row no-gutters align-items-center"},r.a.createElement("div",{className:"col  d-flex justify-content-start align-items-center"},r.a.createElement("span",null,r.a.createElement("h1",{className:"mb-3"},a)),r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-pill badge-primary ml-2"},t))))},le=Object(n.memo)(function(){var e=Object(n.useContext)(v).state;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,{total:e.total,title:"Animes"}),r.a.createElement(se,null))}),ue=function(){return r.a.createElement("h1",null,"Not Found")},ie=a(7),me=a.n(ie),de=function(){var e=Object(n.useReducer)(function(e,t){var a=t.payload;switch(t.type){case"SET_GENRES":return Object(u.a)({},e,{genres:a});case"SET_STUDIOS":return Object(u.a)({},e,{studios:a});case"SET_SEASONS":return Object(u.a)({},e,{seasons:a});case"SET_TYPES":return Object(u.a)({},e,{types:a});default:return e}},{genres:[],studios:[],types:[],seasons:[]}),t=Object(E.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)(function(){B().then(function(e){r({type:"SET_GENRES",payload:e.genres.map(function(e){return O(e)})})}),T.get("/api/studios").then(function(e){return e.data}).then(function(e){r({type:"SET_STUDIOS",payload:e.studios.map(function(e){return O(e)})})}),r({type:"SET_SEASONS",payload:q}),r({type:"SET_TYPES",payload:J})},[]),{state:a,dispatch:r}},pe=a(21),fe=function(e){var t=e.name,a=e.label,n=e.error,c=Object(f.a)(e,["name","label","error"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t},a),r.a.createElement("input",Object.assign({},c,{name:t,id:t,className:"form-control"})),n&&r.a.createElement("p",{className:"text-danger p-2 "},n))},Ee=a(54),be=a(57),he=(a(102),function(e){var t=Object(n.useState)(!1),a=Object(E.a)(t,2),c=a[0],s=a[1],o=e.data||{},l=o.data,i=o.setData,m=e.errors||{},d=m.errors,p=m.setErrors,f=Object(u.a)({},e.schema),b=function(){var e=me.a.validate(l,f,{abortEarly:!1}).error;if(!e)return null;var t={},a=!0,n=!1,r=void 0;try{for(var c,s=e.details[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var o=c.value;t[o.path[0]]=o.message}}catch(u){n=!0,r=u}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return t},h=function(e){var t=e.currentTarget,a=Object(u.a)({},d),n=function(e){var t=e.name,a=e.value,n=Object(pe.a)({},t,a),r=Object(pe.a)({},t,f[t]),c=me.a.validate(n,r).error;return c?c.details[0].message:null}(t);n?a[t.name]=n:delete a[t.name];var r=g(t,a,l.password),c=Object(u.a)({},l);c[t.name]=t.value,i(c),p(r)},g=function(e,t,a){var n=Object(u.a)({},t);return"confirmPassword"===e.name&&e.value===a&&delete n[e.name],n};return r.a.createElement("form",{onSubmit:function(t){return function(e,t){e.preventDefault();var a=b();p(a||{}),a||(s(!0),t(e,l),s(!1))}(t,e.onSubmit)}},e.children({renderButton:function(e,t){return r.a.createElement("button",{disabled:b()||Object.keys(d).length>0||c,className:"btn btn-primary mt-3"},r.a.createElement("span",{className:"".concat(t," mr-1")}),e)},renderInput:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3?arguments[3]:void 0;return r.a.createElement(fe,Object.assign({type:a,name:e,value:l[e],label:t,onChange:h,error:d[e]},n))},renderTextArea:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement("textarea",{value:l[e],onChange:h,className:"form-control",id:e,rows:a,name:e}),d[e]&&r.a.createElement("div",{className:"alert p-2 mt-2 alert-danger"},d[e]))},renderDatePicker:function(e,t,a){return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement("div",null,r.a.createElement(Ee.a,Object.assign({peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",placeholderText:"Select a date",className:"form-control",value:l[e]},a))),d[e]&&r.a.createElement("div",{className:"alert p-2 mt-2 alert-danger"},d[e]))},renderSelect:function(e,t,a,n,c,s){return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement(be.a,Object.assign({},s,{isSearchable:!0,isClearable:!0,value:a,onChange:n,options:c})))}}))}),ge=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:" d-flex justify-content-end"}),r.a.createElement("button",{onClick:function(){return e.history.goBack()},className:"btn btn-secondary"},r.a.createElement("span",{className:"fa fa-arrow-left mr-1"}),"BACK"))},ve=Object(n.memo)(K(function(e){var t=e.auth,a=Object(f.a)(e,["auth"]),c=Object(n.useContext)(v),s=a.match.params.id,o=de().state,i=o.genres,d=o.studios,b=o.seasons,h=o.types,g=Object(n.useState)({id:0,title:"",description:"",season:"",type:"",releaseDate:"",genres:[],studios:[]}),j=Object(E.a)(g,2),S=j[0],y=j[1],w=Object(n.useState)({}),x=Object(E.a)(w,2),k=x[0],T=x[1],A=Object(n.useState)([]),C=Object(E.a)(A,2),I=C[0],D=C[1],_=Object(n.useState)([]),P=Object(E.a)(_,2),F=P[0],U=P[1],R=Object(n.useState)(null),M=Object(E.a)(R,2),L=M[0],B=M[1],q=Object(n.useState)(null),J=Object(E.a)(q,2),z=J[0],Y=J[1],K={id:me.a.number().integer(),title:me.a.string().min(3).required().label("Title"),description:me.a.optional(),season:me.a.optional(),type:me.a.optional(),releaseDate:me.a.optional(),imageUrl:me.a.optional(),genres:me.a.array().optional(),studios:me.a.array().optional()};Object(n.useEffect)(function(){Q()},[]);var Q=function(){var e=Object(p.a)(m.a.mark(function e(){var t,n,r,c,o,l,u;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==s){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,G(s);case 5:t=e.sent,n=t.anime,r=X(n),c=r.selectedGenres,o=r.selectedStudios,l=r.selectedSeason,u=r.selectedType,n.releaseDate=N(n.releaseDate),y(n),D(c),U(o),B(l),Y(u),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),e.t0.response&&404===e.t0.response.status&&a.history.replace("/not-found");case 19:case"end":return e.stop()}},e,this,[[0,16]])}));return function(){return e.apply(this,arguments)}}(),X=function(e){return{selectedGenres:e.genres.map(function(e){return O(e)}),selectedStudios:e.studios.map(function(e){return O(e)}),selectedSeason:O({id:null,name:e.season}),selectedType:O({id:null,name:e.type})}},Z=function(){var e=Object(p.a)(m.a.mark(function e(){var n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isAdmin()){e.next=3;break}return l.toast.error("Unauthorized user"),e.abrupt("return");case 3:if(!(n=$(S)).id){e.next=9;break}return e.next=7,H(n.id,n);case 7:e.next=11;break;case 9:return e.next=11,V(n);case 11:a.history.replace("/"),n.id?l.toast.success("Updated"):l.toast.success("Added"),c.onRefresh();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),$=function(e){var t=Object(u.a)({},e);return t.genreIds=I.map(function(e){return e.id})||[],t.studioIds=F.map(function(e){return e.id})||[],t.season=L?L.value:null,t.type=z?z.value:null,t.releaseDate?t.releaseDate=new Date(t.releaseDate).toISOString():delete t.releaseDate,t},ee=function(e){return D(e)},te=function(e){return B(e)},ae=function(e){return Y(e)},ne=function(e){return U(e)},re=function(e){var t=Object(u.a)({},S);t.releaseDate=N(e),y(t)},se=function(e){return r.a.createElement("span",{className:""},r.a.createElement(W.a,{to:e},r.a.createElement("button",{className:"add-btn btn  btn-secondary btn-md "},"...")))};return r.a.createElement(ce,{isLoaded:d.length>0||"new"===s},r.a.createElement("div",{className:"col-8 offset-2"},r.a.createElement("h1",null,"new"!==s?"Edit Form":"Add Form"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ge,a)),r.a.createElement(he,{data:{data:S,setData:y},errors:{errors:k,setErrors:T},onSubmit:Z,schema:K},function(e){var t=e.renderButton,a=e.renderInput,n=e.renderSelect,c=e.renderTextArea,o=e.renderDatePicker;return r.a.createElement(r.a.Fragment,null,a("title","Title"),c("description","Description"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},n("season","Season",L,te,b)),r.a.createElement("div",{className:"col-6"},o("releaseDate","Release",{onChange:re}))),n("type","Type",z,ae,h),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-11"},n("genreIds","Genres",I,ee,i,{isMulti:!0})),r.a.createElement("div",{className:"col-1 mt-4"},se("/genres/new"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-11"},n("studioIds","Studios",F,ne,d,{isMulti:!0})),r.a.createElement("div",{className:"col-1 mt-4"},se("/studios/new"))),a("imageUrl","Image Url"),t("new"!==s?"UPDATE":"SAVE","fa fa-save"))}),r.a.createElement("style",{jsx:""},"\n          .add-btn {\n            margin-top: 7px;\n          }\n        ")))})),je=K(function(e){var t=e.auth,a=Object(f.a)(e,["auth"]),c=Object(n.useState)({username:"",password:""}),s=Object(E.a)(c,2),o=s[0],u=s[1],i=Object(n.useState)({}),d=Object(E.a)(i,2),b=d[0],h=d[1],g={username:me.a.string().required().label("Username"),password:me.a.string().required().label("Password")},v=function(){var e=Object(p.a)(m.a.mark(function e(n,r){var c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.login(r);case 3:l.toast.success("Welcome, ".concat(w(r.username))),a.history.replace("/home"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(c=e.t0.response)&&401===c.status&&l.toast.error(c.data.status.errors);case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"col-6 offset-3 mt-5"},r.a.createElement("h1",null,"Login"),r.a.createElement(he,{data:{data:o,setData:u},errors:{errors:b,setErrors:h},onSubmit:v,schema:g},function(e){var t=e.renderButton,a=e.renderInput;return r.a.createElement(r.a.Fragment,null,a("username","Username"),a("password","Password","password"),t("Login"))}))}),Se=K(function(e){var t=e.auth,a=Object(f.a)(e,["auth"]),c=Object(n.useState)({username:"",password:"",email:"",confirmPassword:""}),s=Object(E.a)(c,2),o=s[0],i=s[1],d=Object(n.useState)({}),b=Object(E.a)(d,2),h=b[0],g=b[1],v={username:me.a.string().required().min(6).label("Username"),email:me.a.string().required().email().label("Email"),password:me.a.string().required().min(6).label("Password"),confirmPassword:me.a.string().required().valid(me.a.ref("password")).options({language:{any:{allowOnly:"not match"}}}).label("Password")},j=function(){var e=Object(p.a)(m.a.mark(function e(a){var n,r,c,s;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("username"!==(n=a.currentTarget).name){e.next=7;break}return e.next=4,t.isUsernameTaken(n.value);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,t.isEmailTaken(n.value);case 9:e.t0=e.sent;case 10:return r=e.t0,c=r.isTaken,s=Object(u.a)({},h),c?s[n.name]='"'.concat(w(n.name),'" is taken'):delete s[n.name],g(s),e.abrupt("return",s);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(p.a)(m.a.mark(function e(n){var r,c,s;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(n);case 2:if(r=e.sent,!(Object.keys(r).length>0)){e.next=5;break}return e.abrupt("return");case 5:return c=Object(u.a)({},o),e.prev=6,e.next=9,t.register(c);case 9:l.toast.success("Welcome, "+w(o.username)),i({username:"",password:"",email:"",confirmPassword:""}),g(r),a.history.replace("/"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(6),(s=e.t0.response)&&400===s.status&&l.toast.error(s.data.status.errors);case 19:case"end":return e.stop()}},e,this,[[6,15]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"col-6 offset-3 mt-5"},r.a.createElement("h1",null,"Register"),r.a.createElement(he,{data:{data:o,setData:i},errors:{errors:h,setErrors:g},onSubmit:S,schema:v},function(e){var t=e.renderButton,a=e.renderInput;return r.a.createElement(r.a.Fragment,null,a("username","Username","text",{onBlur:j}),a("email","Email","email",{onBlur:j}),a("password","Password","password"),a("confirmPassword","Confirm Password","password"),t("Register"))}))}),ye=K(function(e){var t=e.isAdmin,a=void 0!==t&&t,n=e.auth,c=(e.path,e.component),s=e.render,o=Object(f.a)(e,["isAdmin","auth","path","component","render"]);return r.a.createElement(Z.a,Object.assign({},o,{render:function(e){return n.isValidUser()?a&&!n.isAdmin()?r.a.createElement($.a,{to:"/not-found"}):c?r.a.createElement(c,e):s(e):r.a.createElement($.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}),Ne=K(function(e){var t=e.auth,a=(e.path,e.component),n=e.render,c=Object(f.a)(e,["auth","path","component","render"]);return r.a.createElement(Z.a,Object.assign({},c,{render:function(e){return t.isValidUser()?r.a.createElement($.a,{to:{pathname:"/",state:{from:e.location}}}):a?r.a.createElement(a,e):n(e)}}))}),Oe=function(e,t){var a=Object(pe.a)({},t,[]),r=Object(n.useReducer)(function(e,a){var n=a.payload;switch(a.type){case"SET_ITEMS":return Object(u.a)({},e,Object(pe.a)({},t,n));default:return e}},a),c=Object(E.a)(r,2),s=c[0],o=c[1];return Object(n.useEffect)(function(){e().then(function(e){o({type:"SET_ITEMS",payload:e[t]})})},[]),{state:s,dispatch:o}},we=function(){var e=Oe(B,"genres"),t=e.state.genres,a=e.dispatch,c=Object(n.useState)({path:"name",order:"asc"}),s=Object(E.a)(c,2),o=s[0],l=s[1],u=[{path:"name",label:"Name",content:function(e){return r.a.createElement(W.a,{to:"/genres/".concat(e.id)},e.name)}},{key:"actions",label:"Actions",content:function(e){return r.a.createElement("div",{className:"d-flex"},r.a.createElement(W.a,{to:"/genres/".concat(e.id)},r.a.createElement("button",{className:"btn btn-warning btn-sm mr-1 fa fa-pencil text-white"})),r.a.createElement("button",{className:"btn btn-danger btn-sm fa fa-trash text-white"}))}}];return r.a.createElement("div",{className:"col-6 offset-3 "},r.a.createElement(oe,{total:t.length,title:"Genres"}),r.a.createElement(ae,{columns:u,data:t,sortColumn:o,onSort:function(e){a({type:"SET_ITEMS",payload:y(t,e)}),l(e)}}))};function xe(e){return T.setJwt(M.jwt()),T.post("/api/genres",e).then(function(e){return e.data})}var ke=function(e){var t=Object(n.useState)({id:0,name:""}),a=Object(E.a)(t,2),c=a[0],s=a[1],o=Object(n.useState)({}),i=Object(E.a)(o,2),d=i[0],f=i[1],b={id:me.a.number().integer(),name:me.a.string().required().label("Name")},h=function(){var e=Object(p.a)(m.a.mark(function e(){var t,a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe(c);case 3:l.toast.success("Added"),g(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(t=e.t0.response)&&400===t.data.status.code&&((a=Object(u.a)({},d)).name=t.data.status.error,f(a));case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),g=function(){return e.history.goBack()};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-6 offset-3"},r.a.createElement("h1",null,"Add Genre"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ge,e)),r.a.createElement(he,{data:{data:c,setData:s},errors:{errors:d,setErrors:f},schema:b,onSubmit:h},function(e){var t=e.renderInput,a=e.renderButton;return r.a.createElement(r.a.Fragment,null,t("name","Name"),a("Save"))})))};function Te(e){return T.setJwt(M.jwt()),T.post("/api/studios",e).then(function(e){return e.data})}var Ae=Object(n.memo)(function(e){var t=Object(n.useState)({id:0,name:""}),a=Object(E.a)(t,2),c=a[0],s=a[1],o=Object(n.useState)({}),i=Object(E.a)(o,2),d=i[0],f=i[1],b={id:me.a.number().integer(),name:me.a.string().required().label("Name")},h=function(){var e=Object(p.a)(m.a.mark(function e(){var t,a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Te(c);case 3:l.toast.success("Added"),g(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(t=e.t0.response)&&400===t.data.status.code&&((a=Object(u.a)({},d)).name=t.data.status.error,f(a));case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),g=function(){return e.history.goBack()};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-6 offset-3"},r.a.createElement("h1",null,"Add Studio"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ge,e)),r.a.createElement(he,{data:{data:c,setData:s},errors:{errors:d,setErrors:f},schema:b,onSubmit:h},function(e){var t=e.renderInput,a=e.renderButton;return r.a.createElement(r.a.Fragment,null,t("name","Name"),a("Save"))})))}),Ce=function(){return r.a.createElement(X.a,null,r.a.createElement(ye,{path:"/home",component:le}),r.a.createElement(Ne,{path:"/login",component:je}),r.a.createElement(Ne,{path:"/register",component:Se}),r.a.createElement(ye,{isAdmin:!0,path:"/animes/:id",component:ve}),r.a.createElement(ye,{isAdmin:!0,path:"/studios/new",component:Ae}),r.a.createElement(ye,{isAdmin:!0,path:"/genres/new",component:ke}),r.a.createElement(ye,{path:"/genres",component:we}),r.a.createElement(Z.a,{path:"/not-found",component:ue}),">",r.a.createElement($.a,{from:"/",exact:!0,to:"/home"}),r.a.createElement($.a,{to:"/not-found"}))},Ie=(a(111),a(113),function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null,r.a.createElement(Q,null),r.a.createElement(l.ToastContainer,{autoClose:3e3}),r.a.createElement("main",{className:"container"},r.a.createElement(Ce,null))))});a(115),a(117);s.a.render(r.a.createElement(o.a,null,r.a.createElement(Ie,null)),document.getElementById("root"))},18:function(e){e.exports={a:"https://kitchanime-node.herokuapp.com",b:{perPage:10,pageNumbers:3}}},58:function(e,t,a){e.exports=a(119)},63:function(e,t,a){}},[[58,2,1]]]);
//# sourceMappingURL=main.5f453ea9.chunk.js.map