(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,a){},119:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(17),c=a.n(s),o=a(123),l=(a(63),a(9)),u=a(2),i=a.n(u),m=a(56),d=a(8),p=a(11),f=a(4),b=a(5),E=function(e,t){var a=t.payload;switch(t.type){case"SET_PAGENUM":return Object(b.a)({},e,{pageNum:a});case"SET_ITEMS":return Object(b.a)({},e,{items:a});case"SET_PAGES":return Object(b.a)({},e,{pages:a});case"SET_TOTAL":return Object(b.a)({},e,{total:a});case"SET_REFRESH":return Object(b.a)({},e,{toggle:a});case"SEARCH_ITEMS":return Object(b.a)({},e,{title:a});default:return e}},h=function(e){var t=e.request,a=e.data,r=void 0===a?"data":a,s=e.pages,c=void 0===s?"lastPage":s,o=e.total,u=void 0===o?"total":o,i=e.take,m=void 0===i?15:i,d={items:[],pageNum:1,pages:0,total:0,take:m,toggle:!1},h=Object(n.useReducer)(E,d),v=Object(f.a)(h,2),g=v[0],j=g.toggle,N=g.title,O=g.pageNum,y=Object(p.a)(g,["toggle","title","pageNum"]),S=v[1];return Object(n.useEffect)(function(){t(O,m,N).then(function(e){S({type:"SET_ITEMS",payload:e[r]}),S({type:"SET_PAGES",payload:e[c]}),S({type:"SET_TOTAL",payload:e[u]})}).catch(function(e){var t=e.response;t&&404===t.status&&(S({type:"SET_ITEMS",payload:[]}),S({type:"SET_PAGES",payload:0}),S({type:"SET_TOTAL",payload:0}),S({type:"SET_PAGENUM",payload:1}),l.toast.error("No result/s found"))})},[j,N,O]),{state:Object(b.a)({toggle:j,pageNum:O,take:m},y),dispatch:S}},v=r.a.createContext({}),g=a(18),j=a(27),N=a.n(j);function O(e,t){return N.a.orderBy(e,[t.path],[t.order])}var y=function(e){return e?new Date(e).toLocaleDateString():null},S=function(e){var t=e.id,a=e.name;return{id:t,label:w(a),value:a}},w=function(e){return N.a.startCase(e)},x=a(20),k=a.n(x);k.a.interceptors.response.use(function(e){return e},function(e){return function(e){e.response&&e.response.status>=400&&e.response.status<500||l.toast.error("An unexpected error occurrred.");if(e.response&&e.response.data.status&&"ExpiredJwtToken"===e.response.data.status.name)return l.toast.error("jwt is expired"),Promise.reject(e);return Promise.reject(e)}(e)}),k.a.interceptors.request.use(function(e){return e.baseURL=Object({NODE_ENV:"production",PUBLIC_URL:""}).API_URL||g.a,e});var T={get:k.a.get,post:k.a.post,put:k.a.put,delete:k.a.delete,axios:k.a,setJwt:function(e){var t=e.token;k.a.interceptors.request.use(function(e){return e.headers.Authorization="Bearer ".concat(t),e})}};var A=a(48),C=a.n(A);function I(e){var t=e.token,a=e.refreshToken;localStorage.setItem("access-token",t),localStorage.setItem("refresh-token",a)}function D(){return(D=Object(d.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/auth/login",t).then(function(e){I(e.data.jwt)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function P(){return(P=Object(d.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/auth/register",t).then(function(e){return e.data});case 2:if(a=e.sent,n=a.jwt){e.next=6;break}return e.abrupt("return",!1);case 6:return I(n),e.abrupt("return",!0);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function _(){return(_=Object(d.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.setJwt(R()),F(),e.next=4,T.post("/token/revoke",{refreshToken:R().refreshToken});case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function F(){localStorage.removeItem("refresh-token"),localStorage.removeItem("access-token")}function U(){try{var e=localStorage.getItem("access-token");return Object(b.a)({},C()(e))}catch(t){return null}}var R=function(){return{token:localStorage.getItem("access-token"),refreshToken:localStorage.getItem("refresh-token")}},M={login:function(e){return D.apply(this,arguments)},register:function(e){return P.apply(this,arguments)},logout:function(){return _.apply(this,arguments)},getCurrentUser:function(){return U()?Object(b.a)({},U().data):null},isUsernameTaken:function(e){return T.get("/auth/is-taken?username="+e).then(function(e){return e.data})},isEmailTaken:function(e){return T.get("/auth/is-taken?email="+e).then(function(e){return e.data})},jwt:R,isValidUser:function(){return!!U()},isAdmin:function(){return U()?U().data.isAdmin:null}};function L(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return T.get("/api/animes/page/".concat(e,"?limit=").concat(t,"&title=").concat(a)).then(function(e){return e.data.data})}function B(){return T.get("/api/genres").then(function(e){return e.data})}function G(e){return T.get("/api/animes/".concat(e)).then(function(e){return e.data})}var q=[{label:"Winter",value:"winter"},{label:"Spring",value:"spring"},{label:"Summer",value:"summer"},{label:"Fall",value:"fall"}],J=[{label:"TV",value:"tv"},{label:"Movie",value:"movie"},{label:"OVA",value:"ova"},{label:"ONA",value:"ona"},{label:"Other",value:"other"}];function V(e){return T.setJwt(M.jwt()),T.post("/api/animes",e).then(function(e){return e.data})}function H(e,t){return T.setJwt(M.jwt()),T.put("/api/animes/"+e,t).then(function(e){return e.data})}var z=Object(n.memo)(function(e){var t=h({request:L,take:g.b.perPage}),a=t.state,n=a.pageNum,s=a.items,c=a.pages,o=a.total,l=t.dispatch,u=function(){var e=Object(d.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(m.a)(s),e.prev=1,n=a.filter(function(e){return e.id!==t.id}),l({type:"SET_ITEMS",payload:n}),e.next=6,r=t.id,T.setJwt(M.jwt()),T.delete("/api/animes/"+r).then(function(e){return e.data});case 6:return e.abrupt("return",n.length>0);case 9:return e.prev=9,e.t0=e.catch(1),l({type:"SET_ITEMS",payload:a}),e.abrupt("return",a.length>0);case 13:case"end":return e.stop()}var r},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(v.Provider,{value:{state:{animes:s,pages:c,pageNum:n,total:o},onDelete:u,onRefresh:function(){l({type:"SET_REFRESH",payload:function(e){return!e}})},onPageChange:function(e){l({type:"SET_PAGENUM",payload:e})},onSort:function(e){l({type:"SET_ITEMS",payload:O(s,e)})},onSearch:function(e){l({type:"SEARCH_ITEMS",payload:e})}}},e.children)}),W=a(96),Y=a(121),K=function(e){return function(t){return r.a.createElement(e,Object.assign({auth:M},t))}},Q=K(function(e){var t=e.auth,a=(Object(p.a)(e,["auth"]),function(){var e=Object(d.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.logout();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}());return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement("div",{className:"container"},r.a.createElement(W.a,{className:"navbar-brand",to:"/"},"KITCHANIME"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse d-flex justify-content-end",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav"},t.isValidUser()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-user  text-warning"}),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link active",to:"/home"},w(t.getCurrentUser().username))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"/login",onClick:a},"Logout"))),!t.isValidUser()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link",to:"/login"},"Login")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Y.a,{className:"nav-link",to:"/register"},"Register")))))),r.a.createElement("style",{jsx:""},"\n          .navbar {\n            margin-bottom: 20px;\n          }\n          .fa-user {\n            margin-top: 12px !important;\n          }import withAuth from './../auth/registerForm';\n\n        ")))}),X=a(124),Z=a(120),$=a(122),ee=function(e){return r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,e.columns.map(function(t,a){return r.a.createElement("th",{className:"clickable",key:a,onClick:function(){return function(t){var a=Object(b.a)({},e.sortColumn);a.path===t?a.order="asc"===a.order?"desc":"asc":(a.path=t,a.order="asc"),e.onSort(a)}(t.path)}},t.label," ",function(t){var a=e.sortColumn;return t.path?t.path!==a.path?null:"asc"===a.order?r.a.createElement("i",{className:"fa fa-sort-asc"}):r.a.createElement("i",{className:"fa fa-sort-desc"}):null}(t))})))},te=function(e){var t=e.data,a=e.columns;return r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement("tr",{key:e.id},a.map(function(t,a){return r.a.createElement("td",{key:a},function(e,t){return t.content?t.content(e):N.a.get(e,t.path)}(e,t))}))}))},ae=function(e){var t=e.columns,a=e.sortColumn,n=e.onSort,s=e.data;return r.a.createElement("table",{className:"table table-bordered table-hover "},r.a.createElement(ee,{columns:t,sortColumn:a,onSort:n}),r.a.createElement(te,{columns:t,data:s}))},ne=function(e){var t=e.start,a=e.end,s=e.setStart,c=e.setEnd,o=g.b.pageNumbers,l=Object(n.useContext)(v),u=l.state,i=u.pageNum,m=u.pages,d=l.onPageChange;Object(n.useEffect)(function(){a>m&&1!==t&&(s(t-1),c(a-1))},[i]);var p=function(e){i!==e&&d(e)},f=function(){return m>o},b=function(){return 1===i?"disabled":""},E=function(){return m===i?"disabled":""};return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col d-flex justify-content-start px-0"},r.a.createElement("nav",null,r.a.createElement("ul",{className:"pagination"},f()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"page-item ".concat(b())},r.a.createElement("button",{className:"page-link",onClick:function(){1!==i&&(p(1),s(1),c(o))}},"first")),r.a.createElement("li",{className:"page-item ".concat(b())},r.a.createElement("button",{className:"page-link","aria-label":"Previous",onClick:function(){return p(i-1),void(1!==t&&(s(t-1),c(a-1)))}},"\xab"))),m>1&&function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a}(t,m<o?m:a).map(function(e){return r.a.createElement("li",{key:e,className:i===e?"page-item active":"page-item"},r.a.createElement("button",{className:"page-link",onClick:function(){return p(e)}},e))}),f()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"page-item ".concat(E())},r.a.createElement("button",{className:"page-link","aria-label":"Next",onClick:function(){return function(e){p(e+1),a!==m&&(s(t+1),c(a+1))}(i)}},"\xbb")),r.a.createElement("li",{className:"page-item ".concat(E())},r.a.createElement("button",{className:"page-link",onClick:function(){p(m),s(m-(o-1)),c(m)}},"last")))))),r.a.createElement("div",{className:"pages px-0 col d-flex justify-content-end"},r.a.createElement("p",{className:"page-of"},"".concat(i," of ").concat(m))),r.a.createElement("style",{jsx:""},"\n            .pages {\n              text-align: right;\n            }\n            .page-of {\n              margin-top: 10px;\n            }\n          ")))},re=function(e){var t=Object(n.useContext)(v),a=t.onPageChange,s=t.onSearch,c=Object(n.useState)(""),o=Object(f.a)(c,2),l=o[0],u=o[1],m=function(){var t=Object(d.a)(i.a.mark(function t(n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),l){t.next=3;break}return t.abrupt("return");case 3:e.setStart(1),e.setEnd(g.b.pageNumbers),a(1),s(l);case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:m},r.a.createElement("input",{type:"text",name:l,value:l,onChange:function(e){return u(e.target.value)},className:"form-control",placeholder:"Search title"}),r.a.createElement("button",{className:"btn-search btn btn-primary ml-2"},r.a.createElement("span",{className:"fa fa-search mr-1"}),"SEARCH")),r.a.createElement("style",{jsx:""},"\n        form {\n          display: flex;\n        }\n        .btn-search {\n          width: 13%;\n        }\n      "))},se=function(e){var t=e.isLoaded,a=e.children;return r.a.createElement(r.a.Fragment,null,!t&&r.a.createElement("div",{className:"spin d-flex justify-content-center justify-items-center"},r.a.createElement("div",{className:"spinner spinner-grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),t&&a,r.a.createElement("style",{jsx:""},"\n        .spin {\n          position: fixed;\n          z-index: 1031;\n          top: 40%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n      "))},ce=K(function(e){var t=e.auth,a=(Object(p.a)(e,["auth"]),g.b.pageNumbers),s=Object(n.useContext)(v),c=s.state,o=c.animes,u=c.pageNum,m=c.total,b=s.onDelete,E=s.onRefresh,h=s.onPageChange,j=s.onSort,N=s.onSearch,O=Object(n.useState)(1),S=Object(f.a)(O,2),w=S[0],x=S[1],k=Object(n.useState)(a),T=Object(f.a)(k,2),A=T[0],C=T[1],I=Object(n.useState)({path:"name",order:"asc"}),D=Object(f.a)(I,2),P=D[0],_=D[1],F=[{path:"title",label:"Title",content:function(e){return r.a.createElement(W.a,{to:"/animes/".concat(e.id)},e.title)}},{path:"season",label:"Season"},{path:"releaseDate",label:"Release"},{path:"type",label:"Type"},{label:"Genres",content:function(e){return R(e.genres)}},{label:"Studios",content:function(e){return R(e.studios)}},{key:"actions",label:"Actions",content:function(e){return r.a.createElement("div",{className:""},r.a.createElement(W.a,{to:"/animes/".concat(e.id)},r.a.createElement("button",{className:"btn btn-warning btn-sm mr-1 text-white"},r.a.createElement("span",{className:"fa fa-pencil mr-1"}),"EDIT")),r.a.createElement("button",{onClick:Object(d.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)})),className:"btn btn-danger btn-sm text-white"},r.a.createElement("span",{className:"fa fa-trash mr-1"}),"DELETE"))}}],U=function(){var e=Object(d.a)(i.a.mark(function e(a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isAdmin()){e.next=3;break}return l.toast.error("Unauthorized user"),e.abrupt("return");case 3:return e.next=5,b(a);case 5:if(e.sent){e.next=10;break}return h(u-1),w>1&&x(w-1),C(A-1),e.abrupt("return");case 10:E();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),R=function(e){return e.map(function(e,t){return r.a.createElement("span",{key:t,className:"badge ml-1  badge-secondary"},e.name)})},M={start:w,end:A,setStart:x,setEnd:C};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row no-gutters "},r.a.createElement("div",{className:"col-6 d-flex justify-content-start "},t.isAdmin()&&r.a.createElement(W.a,{to:"/animes/new"},r.a.createElement("button",{className:"btn btn-success mr-2 mt-1"},r.a.createElement("span",{className:"fa fa-plus mr-1"}),"NEW ANIME")),r.a.createElement("div",null,r.a.createElement(W.a,{to:"/"},r.a.createElement("button",{onClick:function(){return N("")},className:"btn btn-secondary mt-1"},r.a.createElement("span",{className:"fa fa-refresh mr-1"}),"REFRESH"))))),r.a.createElement("div",{className:"col-12 mb-2 mt-3",style:{padding:0}},r.a.createElement(re,M)),r.a.createElement(se,{isLoaded:m>0},r.a.createElement(ae,{columns:t.isAdmin()?F:[].concat(F).filter(function(e){return"actions"!==e.key}),data:o.map(function(e){return e.releaseDate=y(e.releaseDate),e}),sortColumn:P,onSort:function(e){j(e),_(e)}}),r.a.createElement(ne,M)))}),oe=function(e){var t=e.total,a=e.title;return r.a.createElement("div",{className:"row no-gutters align-items-center"},r.a.createElement("div",{className:"col  d-flex justify-content-start align-items-center"},r.a.createElement("span",null,r.a.createElement("h1",{className:"mb-3"},a)),r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-pill badge-primary ml-2"},t))))},le=Object(n.memo)(function(){var e=Object(n.useContext)(v).state;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,{total:e.total,title:"Animes"}),r.a.createElement(ce,null))}),ue=function(){return r.a.createElement("h1",null,"Not Found")},ie=a(7),me=a.n(ie),de=function(){var e=Object(n.useReducer)(function(e,t){var a=t.payload;switch(t.type){case"SET_GENRES":return Object(b.a)({},e,{genres:a});case"SET_STUDIOS":return Object(b.a)({},e,{studios:a});case"SET_SEASONS":return Object(b.a)({},e,{seasons:a});case"SET_TYPES":return Object(b.a)({},e,{types:a});default:return e}},{genres:[],studios:[],types:[],seasons:[]}),t=Object(f.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)(function(){B().then(function(e){r({type:"SET_GENRES",payload:e.genres.map(function(e){return S(e)})})}),T.get("/api/studios").then(function(e){return e.data}).then(function(e){r({type:"SET_STUDIOS",payload:e.studios.map(function(e){return S(e)})})}),r({type:"SET_SEASONS",payload:q}),r({type:"SET_TYPES",payload:J})},[]),{state:a,dispatch:r}},pe=a(21),fe=function(e){var t=e.name,a=e.label,n=e.error,s=Object(p.a)(e,["name","label","error"]);return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t},a),r.a.createElement("input",Object.assign({},s,{name:t,id:t,className:"form-control"})),n&&r.a.createElement("p",{className:"text-danger p-2 "},n))},be=a(54),Ee=a(57),he=(a(102),function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),s=a[0],c=a[1],o=e.data||{},l=o.data,u=o.setData,i=e.errors||{},m=i.errors,d=i.setErrors,p=Object(b.a)({},e.schema),E=function(){var e=me.a.validate(l,p,{abortEarly:!1}).error;if(!e)return null;var t={},a=!0,n=!1,r=void 0;try{for(var s,c=e.details[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var o=s.value;t[o.path[0]]=o.message}}catch(u){n=!0,r=u}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}return t},h=function(e){var t=e.currentTarget,a=Object(b.a)({},m),n=function(e){var t=e.name,a=e.value,n=Object(pe.a)({},t,a),r=Object(pe.a)({},t,p[t]),s=me.a.validate(n,r).error;return s?s.details[0].message:null}(t);n?a[t.name]=n:delete a[t.name];var r=v(t,a,l.password),s=Object(b.a)({},l);s[t.name]=t.value,u(s),d(r)},v=function(e,t,a){var n=Object(b.a)({},t);return"confirmPassword"===e.name&&e.value===a&&delete n[e.name],n};return r.a.createElement("form",{onSubmit:function(t){return function(e,t){e.preventDefault();var a=E();d(a||{}),a||(c(!0),t(e,l),c(!1))}(t,e.onSubmit)}},e.children({renderButton:function(e,t){return r.a.createElement("button",{disabled:E()||Object.keys(m).length>0||s,className:"btn btn-primary mt-3"},r.a.createElement("span",{className:"".concat(t," mr-1")}),e)},renderInput:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3?arguments[3]:void 0;return r.a.createElement(fe,Object.assign({type:a,name:e,value:l[e],label:t,onChange:h,error:m[e]},n))},renderTextArea:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement("textarea",{value:l[e],onChange:h,className:"form-control",id:e,rows:a,name:e}),m[e]&&r.a.createElement("div",{className:"alert p-2 mt-2 alert-danger"},m[e]))},renderDatePicker:function(e,t,a){return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement("div",null,r.a.createElement(be.a,Object.assign({peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",placeholderText:"Select a date",className:"form-control",value:l[e]},a))),m[e]&&r.a.createElement("div",{className:"alert p-2 mt-2 alert-danger"},m[e]))},renderSelect:function(e,t,a,n,s,c){return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:e},t),r.a.createElement(Ee.a,Object.assign({},c,{isSearchable:!0,isClearable:!0,value:a,onChange:n,options:s})))}}))}),ve=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:" d-flex justify-content-end"}),r.a.createElement("button",{onClick:function(){return e.history.goBack()},className:"btn btn-secondary"},r.a.createElement("span",{className:"fa fa-arrow-left mr-1"}),"BACK"))},ge=Object(n.memo)(K(function(e){var t=e.auth,a=Object(p.a)(e,["auth"]),s=Object(n.useContext)(v),c=a.match.params.id,o=de().state,u=o.genres,m=o.studios,E=o.seasons,h=o.types,g=Object(n.useState)({id:0,title:"",description:"",season:"",type:"",genres:[],studios:[],releaseDate:""}),j=Object(f.a)(g,2),N=j[0],O=j[1],w=Object(n.useState)({}),x=Object(f.a)(w,2),k=x[0],T=x[1],A=Object(n.useState)([]),C=Object(f.a)(A,2),I=C[0],D=C[1],P=Object(n.useState)([]),_=Object(f.a)(P,2),F=_[0],U=_[1],R=Object(n.useState)(null),M=Object(f.a)(R,2),L=M[0],B=M[1],q=Object(n.useState)(null),J=Object(f.a)(q,2),z=J[0],Y=J[1],K={id:me.a.number().integer(),title:me.a.string().min(3).required().label("Title"),description:me.a.optional(),season:me.a.optional(),type:me.a.optional(),releaseDate:me.a.optional(),imageUrl:me.a.optional(),genres:me.a.array().optional(),studios:me.a.array().optional()};Object(n.useEffect)(function(){Q()},[]);var Q=function(){var e=Object(d.a)(i.a.mark(function e(){var t,n,r,s,o,l,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"new"!==c){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,G(c);case 5:t=e.sent,n=t.anime,r=X(n),s=r.selectedGenres,o=r.selectedStudios,l=r.selectedSeason,u=r.selectedType,n.releaseDate=y(n.releaseDate),O(n),D(s),U(o),B(l),Y(u),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),e.t0.response&&404===e.t0.response.status&&a.history.replace("/not-found");case 19:case"end":return e.stop()}},e,this,[[0,16]])}));return function(){return e.apply(this,arguments)}}(),X=function(e){return{selectedGenres:e.genres.map(function(e){return S(e)}),selectedStudios:e.studios.map(function(e){return S(e)}),selectedSeason:S({id:null,name:e.season}),selectedType:S({id:null,name:e.type})}},Z=function(){var e=Object(d.a)(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isAdmin()){e.next=3;break}return l.toast.error("Unauthorized user"),e.abrupt("return");case 3:if((n=Object(b.a)({},N)).genreIds=I.map(function(e){return e.id})||[],n.studioIds=F.map(function(e){return e.id})||[],n.season=L?L.value:"",n.type=z?z.value:"",n.releaseDate?n.releaseDate=new Date(n.releaseDate).toISOString():delete n.releaseDate,!n.id){e.next=14;break}return e.next=12,H(n.id,n);case 12:e.next=16;break;case 14:return e.next=16,V(n);case 16:n.id?l.toast.success("Updated"):l.toast.success("Added"),a.history.replace("/"),s.onRefresh();case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),$=function(e){return D(e)},ee=function(e){return B(e)},te=function(e){return Y(e)},ae=function(e){return U(e)},ne=function(e){var t=Object(b.a)({},N);t.releaseDate=y(e),O(t)},re=function(e){return r.a.createElement("span",{className:""},r.a.createElement(W.a,{to:e},r.a.createElement("button",{className:"add-btn btn  btn-secondary btn-md "},"...")))};return r.a.createElement(se,{isLoaded:m.length>0||"new"===c},r.a.createElement("div",{className:"col-8 offset-2"},r.a.createElement("h1",null,"new"!==c?"Edit Form":"Add Form"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ve,a)),r.a.createElement(he,{data:{data:N,setData:O},errors:{errors:k,setErrors:T},onSubmit:Z,schema:K},function(e){var t=e.renderButton,a=e.renderInput,n=e.renderSelect,s=e.renderTextArea,o=e.renderDatePicker;return r.a.createElement(r.a.Fragment,null,a("title","Title"),s("description","Description"),n("type","Type",z,te,h),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},n("season","Season",L,ee,E)),r.a.createElement("div",{className:"col-6"},o("releaseDate","Release",{onChange:ne}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-11"},n("genreIds","Genres",I,$,u,{isMulti:!0})),r.a.createElement("div",{className:"col-1 mt-4"},re("/genres/new"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-11"},n("studioIds","Studios",F,ae,m,{isMulti:!0})),r.a.createElement("div",{className:"col-1 mt-4"},re("/studios/new"))),a("imageUrl","Image Url"),t("new"!==c?"UPDATE":"SAVE","fa fa-save"))}),r.a.createElement("style",{jsx:""},"\n          .add-btn {\n            margin-top: 7px;\n          }\n        ")))})),je=K(function(e){var t=e.auth,a=Object(p.a)(e,["auth"]),s=Object(n.useState)({username:"",password:""}),c=Object(f.a)(s,2),o=c[0],u=c[1],m=Object(n.useState)({}),b=Object(f.a)(m,2),E=b[0],h=b[1],v={username:me.a.string().required().label("Username"),password:me.a.string().required().label("Password")},g=function(){var e=Object(d.a)(i.a.mark(function e(n,r){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.login(r);case 3:l.toast.success("Welcome, ".concat(w(r.username))),a.history.replace("/home"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(s=e.t0.response)&&401===s.status&&l.toast.error(s.data.status.errors);case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"col-6 offset-3 mt-5"},r.a.createElement("h1",null,"Login"),r.a.createElement(he,{data:{data:o,setData:u},errors:{errors:E,setErrors:h},onSubmit:g,schema:v},function(e){var t=e.renderButton,a=e.renderInput;return r.a.createElement(r.a.Fragment,null,a("username","Username"),a("password","Password","password"),t("Login"))}))}),Ne=K(function(e){var t=e.auth,a=Object(p.a)(e,["auth"]),s=Object(n.useState)({username:"",password:"",email:"",confirmPassword:""}),c=Object(f.a)(s,2),o=c[0],u=c[1],m=Object(n.useState)({}),E=Object(f.a)(m,2),h=E[0],v=E[1],g={username:me.a.string().required().min(6).label("Username"),email:me.a.string().required().email().label("Email"),password:me.a.string().required().min(6).label("Password"),confirmPassword:me.a.string().required().valid(me.a.ref("password")).options({language:{any:{allowOnly:"not match"}}}).label("Password")},j=function(){var e=Object(d.a)(i.a.mark(function e(a){var n,r,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("username"!==(n=a.currentTarget).name){e.next=7;break}return e.next=4,t.isUsernameTaken(n.value);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,t.isEmailTaken(n.value);case 9:e.t0=e.sent;case 10:return r=e.t0,s=r.isTaken,c=Object(b.a)({},h),s?c[n.name]='"'.concat(w(n.name),'" is taken'):delete c[n.name],v(c),e.abrupt("return",c);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(i.a.mark(function e(n){var r,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(n);case 2:if(r=e.sent,!(Object.keys(r).length>0)){e.next=5;break}return e.abrupt("return");case 5:return s=Object(b.a)({},o),e.prev=6,e.next=9,t.register(s);case 9:l.toast.success("Welcome, "+w(o.username)),u({username:"",password:"",email:"",confirmPassword:""}),v(r),a.history.replace("/"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(6),(c=e.t0.response)&&400===c.status&&l.toast.error(c.data.status.errors);case 19:case"end":return e.stop()}},e,this,[[6,15]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"col-6 offset-3 mt-5"},r.a.createElement("h1",null,"Register"),r.a.createElement(he,{data:{data:o,setData:u},errors:{errors:h,setErrors:v},onSubmit:N,schema:g},function(e){var t=e.renderButton,a=e.renderInput;return r.a.createElement(r.a.Fragment,null,a("username","Username","text",{onBlur:j}),a("email","Email","email",{onBlur:j}),a("password","Password","password"),a("confirmPassword","Confirm Password","password"),t("Register"))}))}),Oe=K(function(e){var t=e.isAdmin,a=void 0!==t&&t,n=e.auth,s=(e.path,e.component),c=e.render,o=Object(p.a)(e,["isAdmin","auth","path","component","render"]);return r.a.createElement(Z.a,Object.assign({},o,{render:function(e){return n.isValidUser()?a&&!n.isAdmin()?r.a.createElement($.a,{to:"/not-found"}):s?r.a.createElement(s,e):c(e):r.a.createElement($.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}),ye=K(function(e){var t=e.auth,a=(e.path,e.component),n=e.render,s=Object(p.a)(e,["auth","path","component","render"]);return r.a.createElement(Z.a,Object.assign({},s,{render:function(e){return t.isValidUser()?r.a.createElement($.a,{to:{pathname:"/",state:{from:e.location}}}):a?r.a.createElement(a,e):n(e)}}))}),Se=function(e,t){var a=Object(pe.a)({},t,[]),r=Object(n.useReducer)(function(e,a){var n=a.payload;switch(a.type){case"SET_ITEMS":return Object(b.a)({},e,Object(pe.a)({},t,n));default:return e}},a),s=Object(f.a)(r,2),c=s[0],o=s[1];return Object(n.useEffect)(function(){e().then(function(e){o({type:"SET_ITEMS",payload:e[t]})})},[]),{state:c,dispatch:o}},we=function(){var e=Se(B,"genres"),t=e.state.genres,a=e.dispatch,s=Object(n.useState)({path:"name",order:"asc"}),c=Object(f.a)(s,2),o=c[0],l=c[1],u=[{path:"name",label:"Name",content:function(e){return r.a.createElement(W.a,{to:"/genres/".concat(e.id)},e.name)}},{key:"actions",label:"Actions",content:function(e){return r.a.createElement("div",{className:"d-flex"},r.a.createElement(W.a,{to:"/genres/".concat(e.id)},r.a.createElement("button",{className:"btn btn-warning btn-sm mr-1 fa fa-pencil text-white"})),r.a.createElement("button",{className:"btn btn-danger btn-sm fa fa-trash text-white"}))}}];return r.a.createElement("div",{className:"col-6 offset-3 "},r.a.createElement(oe,{total:t.length,title:"Genres"}),r.a.createElement(ae,{columns:u,data:t,sortColumn:o,onSort:function(e){a({type:"SET_ITEMS",payload:O(t,e)}),l(e)}}))};function xe(e){return T.setJwt(M.jwt()),T.post("/api/genres",e).then(function(e){return e.data})}var ke=function(e){var t=Object(n.useState)({id:0,name:""}),a=Object(f.a)(t,2),s=a[0],c=a[1],o=Object(n.useState)({}),u=Object(f.a)(o,2),m=u[0],p=u[1],E={id:me.a.number().integer(),name:me.a.string().required().label("Name")},h=function(){var e=Object(d.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe(s);case 3:l.toast.success("Added"),v(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(t=e.t0.response)&&400===t.data.status.code&&((a=Object(b.a)({},m)).name=t.data.status.error,p(a));case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),v=function(){return e.history.goBack()};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-6 offset-3"},r.a.createElement("h1",null,"Add Genre"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ve,e)),r.a.createElement(he,{data:{data:s,setData:c},errors:{errors:m,setErrors:p},schema:E,onSubmit:h},function(e){var t=e.renderInput,a=e.renderButton;return r.a.createElement(r.a.Fragment,null,t("name","Name"),a("Save"))})))};function Te(e){return T.setJwt(M.jwt()),T.post("/api/studios",e).then(function(e){return e.data})}var Ae=Object(n.memo)(function(e){var t=Object(n.useState)({id:0,name:""}),a=Object(f.a)(t,2),s=a[0],c=a[1],o=Object(n.useState)({}),u=Object(f.a)(o,2),m=u[0],p=u[1],E={id:me.a.number().integer(),name:me.a.string().required().label("Name")},h=function(){var e=Object(d.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Te(s);case 3:l.toast.success("Added"),v(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(t=e.t0.response)&&400===t.data.status.code&&((a=Object(b.a)({},m)).name=t.data.status.error,p(a));case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),v=function(){return e.history.goBack()};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-6 offset-3"},r.a.createElement("h1",null,"Add Studio"),r.a.createElement("span",{className:" d-flex justify-content-end"},r.a.createElement(ve,e)),r.a.createElement(he,{data:{data:s,setData:c},errors:{errors:m,setErrors:p},schema:E,onSubmit:h},function(e){var t=e.renderInput,a=e.renderButton;return r.a.createElement(r.a.Fragment,null,t("name","Name"),a("Save"))})))}),Ce=function(){return r.a.createElement(X.a,null,r.a.createElement(Oe,{path:"/home",component:le}),r.a.createElement(ye,{path:"/login",component:je}),r.a.createElement(ye,{path:"/register",component:Ne}),r.a.createElement(Oe,{isAdmin:!0,path:"/animes/:id",component:ge}),r.a.createElement(Oe,{isAdmin:!0,path:"/studios/new",component:Ae}),r.a.createElement(Oe,{isAdmin:!0,path:"/genres/new",component:ke}),r.a.createElement(Oe,{path:"/genres",component:we}),r.a.createElement(Z.a,{path:"/not-found",component:ue}),">",r.a.createElement($.a,{from:"/",exact:!0,to:"/home"}),r.a.createElement($.a,{to:"/not-found"}))},Ie=(a(111),a(113),function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null,r.a.createElement(Q,null),r.a.createElement(l.ToastContainer,{autoClose:3e3}),r.a.createElement("main",{className:"container"},r.a.createElement(Ce,null))))});a(115),a(117);c.a.render(r.a.createElement(o.a,null,r.a.createElement(Ie,null)),document.getElementById("root"))},18:function(e){e.exports={a:"http://127.0.0.1:3333",b:{perPage:3,pageNumbers:3}}},58:function(e,t,a){e.exports=a(119)},63:function(e,t,a){}},[[58,2,1]]]);
//# sourceMappingURL=main.5944655a.chunk.js.map